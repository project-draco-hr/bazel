{
  if (!ruleContext.getRule().getRuleClassObject().supportsConstraintChecking()) {
    return;
  }
  EnvironmentCollection supportedEnvironments=ConstraintSemantics.getSupportedEnvironments(ruleContext);
  if (supportedEnvironments != null) {
    EnvironmentCollection.Builder refinedEnvironments=new EnvironmentCollection.Builder();
    ConstraintSemantics.checkConstraints(ruleContext,supportedEnvironments,refinedEnvironments);
    add(SupportedEnvironmentsProvider.class,new SupportedEnvironments(supportedEnvironments,refinedEnvironments.build()));
  }
}
