{
  try (InputStream in=Files.newInputStream(inPath,StandardOpenOption.READ)){
    FileSystem currentFileSystem=inPath.getFileSystem();
    Header header=Header.parseDelimitedFrom(in);
    readEntriesSegment(primaryConsumers,in,currentFileSystem,header.getPrimaryEntries());
    readEntriesSegment(transitiveConsumers,in,currentFileSystem,header.getTransitiveEntries());
    Path manifestPath=inPath.getFileSystem().getPath(header.getManifestPath().getFilename());
    Preconditions.checkArgument(Files.exists(manifestPath),"The manifest %s, does not exist.",manifestPath);
    return manifestPath;
  }
 }
