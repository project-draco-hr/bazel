{
  Map<String,SkyKey> keys=new HashMap<>(patterns.size());
  for (  String pattern : patterns) {
    try {
      keys.put(pattern,TargetPatternValue.key(pattern,TargetPatternEvaluator.DEFAULT_FILTERING_POLICY,parserPrefix));
    }
 catch (    TargetParsingException e) {
      reportBuildFileError(caller,e.getMessage());
    }
  }
  Map<SkyKey,SkyValue> existingPatterns=graph.getSuccessfulValues(keys.values());
  for (  String pattern : patterns) {
    SkyKey patternKey=keys.get(pattern);
    if (patternKey == null) {
      continue;
    }
    TargetParsingException targetParsingException=null;
    if (existingPatterns.containsKey(patternKey)) {
      TargetPatternValue value=(TargetPatternValue)existingPatterns.get(patternKey);
      if (value != null) {
        precomputedPatterns.put(pattern,value.getTargets().getTargets());
      }
 else {
        targetParsingException=(TargetParsingException)Preconditions.checkNotNull(graph.getException(patternKey),pattern);
      }
    }
    if (targetParsingException != null) {
      reportBuildFileError(caller,targetParsingException.getMessage());
    }
  }
}
