{
  checkArgument(len >= 0);
  checkArgument(off >= 0);
  checkArgument(off + len <= b.length);
  if (remainingBytes == 0) {
    return -1;
  }
  if (bufferLength == 0) {
    readMoreData(in);
  }
  int bytesToCopy=len;
  if (remainingBytes < bytesToCopy) {
    bytesToCopy=(int)remainingBytes;
  }
  if (bufferLength < bytesToCopy) {
    bytesToCopy=bufferLength;
  }
  System.arraycopy(buffer,bufferOffset,b,off,bytesToCopy);
  bufferOffset+=bytesToCopy;
  bufferLength-=bytesToCopy;
  remainingBytes-=bytesToCopy;
  return bytesToCopy;
}
