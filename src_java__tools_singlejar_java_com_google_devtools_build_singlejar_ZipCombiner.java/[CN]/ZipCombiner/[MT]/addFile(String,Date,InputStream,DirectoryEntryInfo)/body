{
  checkNotFinished();
  if (in == null) {
    throw new NullPointerException();
  }
  if (filename == null) {
    throw new NullPointerException();
  }
  checkState(!fileNames.containsKey(filename),"jar already contains a file named %s",filename);
  int dosTime=dateToDosTime(date != null ? date : new Date());
  copyStreamToEntry(filename,in,dosTime,NO_EXTRA_ENTRIES,mode != OutputMode.FORCE_STORED,directoryEntryInfo);
}
