{
  long bytesCopied=0;
  inflater.reset();
  MutableInt consumedBytes=new MutableInt(0);
  while (!inflater.finished()) {
    inflateData(in,inflaterBuffer,0,inflaterBuffer.length,consumedBytes);
    int bytesRead=consumedBytes.getValue();
    if (skip == SkipMode.COPY) {
      write(buffer,bufferOffset,bytesRead);
    }
    bufferOffset+=bytesRead;
    bufferLength-=bytesRead;
    bytesCopied+=bytesRead;
  }
  return bytesCopied;
}
