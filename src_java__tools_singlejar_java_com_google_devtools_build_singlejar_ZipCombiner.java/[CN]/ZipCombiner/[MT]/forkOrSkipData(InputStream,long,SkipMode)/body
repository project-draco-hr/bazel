{
  checkArgument(length >= 0);
  while (length > 0) {
    if (bufferLength == 0) {
      readMoreData(in);
    }
    int bytesToWrite=(length < bufferLength) ? (int)length : bufferLength;
    if (skip == SkipMode.COPY) {
      write(buffer,bufferOffset,bytesToWrite);
      centralDirectory.writeToCentralDirectory(buffer,bufferOffset,bytesToWrite);
    }
    bufferOffset+=bytesToWrite;
    bufferLength-=bytesToWrite;
    length-=bytesToWrite;
  }
}
