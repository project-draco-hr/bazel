{
  BuildConfiguration targetConfig=target.getConfiguration();
  return new RuleContext.Builder(env,(Rule)target.getTarget(),targetConfig,getHostConfigurationForTesting(targetConfig),ruleClassProvider.getPrerequisiteValidator()).setVisibility(NestedSetBuilder.<PackageSpecification>create(Order.STABLE_ORDER,PackageSpecification.EVERYTHING)).setPrerequisites(getPrerequisiteMapForTesting(target)).setConfigConditions(ImmutableSet.<ConfigMatchingProvider>of()).build();
}
