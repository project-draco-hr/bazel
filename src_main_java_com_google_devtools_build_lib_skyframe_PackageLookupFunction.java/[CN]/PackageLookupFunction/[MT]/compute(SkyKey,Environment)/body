{
  PathPackageLocator pkgLocator=PrecomputedValue.PATH_PACKAGE_LOCATOR.get(env);
  PackageIdentifier packageKey=(PackageIdentifier)skyKey.argument();
  if (!packageKey.getRepository().isDefault()) {
    return computeExternalPackageLookupValue(skyKey,env,packageKey);
  }
 else   if (packageKey.getPackageFragment().equals(new PathFragment(ExternalPackage.NAME))) {
    return computeWorkspaceLookupValue(env,packageKey);
  }
  String packageNameErrorMsg=LabelValidator.validatePackageName(packageKey.getPackageFragment().getPathString());
  if (packageNameErrorMsg != null) {
    return PackageLookupValue.invalidPackageName("Invalid package name '" + packageKey + "': "+ packageNameErrorMsg);
  }
  if (deletedPackages.get().contains(packageKey)) {
    return PackageLookupValue.deletedPackage();
  }
  for (  Path packagePathEntry : pkgLocator.getPathEntries()) {
    PackageLookupValue value=getPackageLookupValue(env,packagePathEntry,packageKey);
    if (value == null || value.packageExists()) {
      return value;
    }
  }
  return PackageLookupValue.noBuildFile();
}
