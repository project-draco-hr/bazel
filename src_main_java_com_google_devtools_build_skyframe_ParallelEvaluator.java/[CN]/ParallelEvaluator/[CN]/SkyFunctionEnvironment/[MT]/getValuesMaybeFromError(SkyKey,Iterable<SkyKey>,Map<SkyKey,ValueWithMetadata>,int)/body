{
  ImmutableMap.Builder<SkyKey,SkyValue> builder=ImmutableMap.builder();
  ArrayList<SkyKey> missingKeys=new ArrayList<>(keySize);
  for (  SkyKey key : keys) {
    NodeEntry entry=directDeps.get(key);
    if (entry != null) {
      SkyValue value=maybeGetValueFromError(key,entry,bubbleErrorInfo);
      if (value != NULL_MARKER) {
        builder.put(key,value);
      }
    }
 else {
      missingKeys.add(key);
    }
  }
  Map<SkyKey,? extends NodeEntry> missingEntries=getBatchValues(requestor,Reason.DEP_REQUESTED,missingKeys);
  for (  SkyKey key : missingKeys) {
    builder.put(key,maybeGetValueFromError(key,missingEntries.get(key),bubbleErrorInfo));
  }
  return builder.build();
}
