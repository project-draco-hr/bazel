{
  if (o == null) {
    throw new NullPointerException();
  }
 else   if (o instanceof String) {
    writeString(buffer,(String)o);
  }
 else   if (o instanceof Integer || o instanceof Double) {
    append(buffer,o.toString());
  }
 else   if (o == Environment.NONE) {
    append(buffer,"None");
  }
 else   if (o == Boolean.TRUE) {
    append(buffer,"True");
  }
 else   if (o == Boolean.FALSE) {
    append(buffer,"False");
  }
 else   if (o instanceof List<?>) {
    List<?> seq=(List<?>)o;
    printList(buffer,seq,EvalUtils.isImmutable(seq));
  }
 else   if (o instanceof SkylarkList) {
    SkylarkList list=(SkylarkList)o;
    printList(buffer,list.toList(),list.isTuple());
  }
 else   if (o instanceof Map<?,?>) {
    Map<?,?> dict=(Map<?,?>)o;
    printList(buffer,dict.entrySet(),"{",", ","}",null);
  }
 else   if (o instanceof Map.Entry<?,?>) {
    Map.Entry<?,?> entry=(Map.Entry<?,?>)o;
    write(buffer,entry.getKey());
    append(buffer,": ");
    write(buffer,entry.getValue());
  }
 else   if (o instanceof SkylarkNestedSet) {
    SkylarkNestedSet set=(SkylarkNestedSet)o;
    append(buffer,"set(");
    printList(buffer,set,"[",", ","]",null);
    Order order=set.getOrder();
    if (order != Order.STABLE_ORDER) {
      append(buffer,", order = \"" + order.getName() + "\"");
    }
    append(buffer,")");
  }
 else   if (o instanceof BaseFunction) {
    BaseFunction func=(BaseFunction)o;
    append(buffer,"<function " + func.getName() + ">");
  }
 else   if (o instanceof Label) {
    write(buffer,o.toString());
  }
 else   if (o instanceof FilesetEntry) {
    FilesetEntry entry=(FilesetEntry)o;
    append(buffer,"FilesetEntry(srcdir = ");
    write(buffer,entry.getSrcLabel().toString());
    append(buffer,", files = ");
    write(buffer,makeStringList(entry.getFiles()));
    append(buffer,", excludes = ");
    write(buffer,makeList(entry.getExcludes()));
    append(buffer,", destdir = ");
    write(buffer,entry.getDestDir().getPathString());
    append(buffer,", strip_prefix = ");
    write(buffer,entry.getStripPrefix());
    append(buffer,", symlinks = \"");
    append(buffer,entry.getSymlinkBehavior().toString());
    append(buffer,"\")");
  }
 else   if (o instanceof PathFragment) {
    append(buffer,((PathFragment)o).getPathString());
  }
 else {
    append(buffer,o.toString());
  }
  return buffer;
}
