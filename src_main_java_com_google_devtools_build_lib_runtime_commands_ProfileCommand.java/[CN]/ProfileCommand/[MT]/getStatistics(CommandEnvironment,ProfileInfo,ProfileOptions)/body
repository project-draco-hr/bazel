{
  try {
    ProfileInfo.aggregateProfile(info,getInfoListener(env));
    env.getReporter().handle(Event.info("Analyzing relationships"));
    info.analyzeRelationships();
    List<ProfilePhaseStatistics> statistics=new ArrayList<>();
    ByteArrayOutputStream byteOutput=new ByteArrayOutputStream();
    PrintStream out=new PrintStream(byteOutput,false,"UTF-8");
    long duration=0;
    for (    ProfilePhase phase : ProfilePhase.values()) {
      ProfileInfo.Task phaseTask=info.getPhaseTask(phase);
      if (phaseTask != null) {
        duration+=info.getPhaseDuration(phaseTask);
      }
    }
    for (    ProfilePhase phase : ProfilePhase.values()) {
      ProfileInfo.Task phaseTask=info.getPhaseTask(phase);
      if (phaseTask != null) {
        long phaseDuration=info.getPhaseDuration(phaseTask);
        out.printf(THREE_COLUMN_FORMAT,"Total " + phase.nick + " phase time",TimeUtilities.prettyTime(phaseDuration),prettyPercentage(phaseDuration,duration));
      }
    }
    out.printf(THREE_COLUMN_FORMAT,"Total run time",TimeUtilities.prettyTime(duration),"100.00%");
    statistics.add(new ProfilePhaseStatistics("Phase Summary Information",new String(byteOutput.toByteArray(),"UTF-8")));
    if (duration > 0) {
      statistics.add(formatInitPhaseStatistics(info,opts));
      statistics.add(formatLoadingPhaseStatistics(info,opts));
      statistics.add(formatAnalysisPhaseStatistics(info,opts));
      ProfilePhaseStatistics stat=formatExecutionPhaseStatistics(info,opts);
      if (stat != null) {
        statistics.add(stat);
      }
    }
    return statistics;
  }
 catch (  UnsupportedEncodingException e) {
    throw new AssertionError("Should not happen since, UTF8 is available on all JVMs");
  }
}
