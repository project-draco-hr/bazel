{
  Iterable<Artifact> mergeeManifests=getMergeeManifests(resourceDeps.getResources());
  if (!Iterables.isEmpty(mergeeManifests)) {
    Iterable<Artifact> exportedManifests=mergeeManifests;
    Artifact outputManifest=ruleContext.getUniqueDirectoryArtifact(ruleContext.getRule().getName() + "_merged","AndroidManifest.xml",ruleContext.getBinOrGenfilesDirectory());
    AndroidManifestMergeHelper.createMergeManifestAction(ruleContext,getManifest(),exportedManifests,ImmutableList.of("all"),outputManifest);
    return new ApplicationManifest(outputManifest);
  }
  return this;
}
