{
  super.setUp();
  reporter=new Reporter();
  buildFileMap=new HashMap<>();
  packageLocator=new CachingPackageLocator(){
    @Override public Path getBuildFileForPackage(    PackageIdentifier packageName){
      return buildFileMap.get(packageName);
    }
  }
;
  ruleClassProvider=TestRuleClassProvider.getRuleClassProvider();
  packageFactory=new PackageFactory(ruleClassProvider,getPackageEnvironmentExtensions());
  serializer=new PackageSerializer();
  deserializer=new PackageDeserializer(createDeserializationEnvironment());
}
