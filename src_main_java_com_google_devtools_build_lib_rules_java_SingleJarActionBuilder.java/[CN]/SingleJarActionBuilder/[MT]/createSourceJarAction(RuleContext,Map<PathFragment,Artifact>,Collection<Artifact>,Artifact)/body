{
  PathFragment javaPath=ruleContext.getHostConfiguration().getFragment(Jvm.class).getJavaExecutable();
  NestedSet<Artifact> hostJavabaseInputs=JavaHelper.getHostJavabaseInputs(ruleContext);
  Artifact singleJar=getSingleJar(ruleContext);
  ruleContext.registerAction(new SpawnAction.Builder().addOutput(outputJar).addInputs(resources.values()).addInputs(resourceJars).addTransitiveInputs(hostJavabaseInputs).setJarExecutable(javaPath,singleJar,JavaToolchainProvider.fromRuleContext(ruleContext).getJvmOptions()).setCommandLine(sourceJarCommandLine(outputJar,resources,resourceJars)).useParameterFile(ParameterFileType.SHELL_QUOTED).setProgressMessage("Building source jar " + outputJar.prettyPrint()).setMnemonic("JavaSourceJar").build(ruleContext));
}
