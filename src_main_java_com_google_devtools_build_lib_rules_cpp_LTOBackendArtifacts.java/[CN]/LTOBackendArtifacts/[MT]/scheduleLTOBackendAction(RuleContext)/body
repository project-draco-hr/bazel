{
  SpawnAction.Builder builder=new SpawnAction.Builder();
  builder.addTransitiveInputs(bitcodeFiles);
  builder.addInput(imports);
  builder.addInput(index);
  builder.addInput(beCommandline);
  builder.addTransitiveInputs(CppHelper.getToolchain(ruleContext).getCompile());
  builder.addTransitiveInputs(CppHelper.getToolchain(ruleContext).getLink());
  builder.addOutput(objectFile);
  builder.setProgressMessage("LTO Backend Compile");
  builder.setMnemonic("CcLtoBackendCompile");
  CppConfiguration cppConfiguration=ruleContext.getFragment(CppConfiguration.class);
  PathFragment compiler=cppConfiguration.getCppExecutable();
  builder.setShellCommand(beCommandline.getExecPathString());
  builder.setEnvironment(ImmutableMap.of("CLANGXX",compiler.replaceName("clang++").getPathString()));
  ruleContext.registerAction(builder.build(ruleContext));
}
