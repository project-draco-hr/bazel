{
  Preconditions.checkNotNull(key);
  Preconditions.checkNotNull(value);
  AnalysisUtils.checkProvider(key);
  Preconditions.checkState(!providers.containsKey(key));
  Preconditions.checkArgument(!SkylarkProviders.class.equals(key),"Do not provide SkylarkProviders directly");
  providers.put(key,value);
  return this;
}
