{
  String mainClass=ruleContext.getRule().isAttrDefined("main_class",Type.STRING) ? ruleContext.attributes().get("main_class",Type.STRING) : "";
  boolean createExecutable=ruleContext.attributes().get("create_executable",Type.BOOLEAN);
  boolean useTestrunner=ruleContext.attributes().get("use_testrunner",Type.BOOLEAN) && !useLegacyJavaTest(ruleContext);
  if (createExecutable) {
    if (useTestrunner) {
      mainClass="com.google.testing.junit.runner.BazelTestRunner";
    }
 else {
      if (mainClass.isEmpty()) {
        mainClass=javaCommon.determinePrimaryClass(javaCommon.getSrcsArtifacts());
      }
    }
  }
  return mainClass;
}
