{
  return new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      Files.createDirectories(valuesPath.getParent());
      try (BufferedWriter writer=Files.newBufferedWriter(valuesPath,StandardCharsets.UTF_8,StandardOpenOption.CREATE_NEW,StandardOpenOption.WRITE)){
        writer.write(START_RESOURCES);
        Path previousSource=null;
        for (        FullyQualifiedName key : Ordering.natural().immutableSortedCopy(segments.keySet())) {
          if (!adopted.contains(key)) {
            for (            Segment segment : segments.get(key)) {
              previousSource=segment.write(previousSource,writer);
            }
          }
        }
        writer.write(END_RESOURCES);
      }
       return Boolean.TRUE;
    }
  }
;
}
