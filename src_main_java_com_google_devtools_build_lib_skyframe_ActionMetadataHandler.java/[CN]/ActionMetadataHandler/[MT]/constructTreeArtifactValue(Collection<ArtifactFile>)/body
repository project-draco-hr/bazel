{
  Map<PathFragment,FileArtifactValue> values=Maps.newHashMapWithExpectedSize(contents.size());
  for (  ArtifactFile file : contents) {
    FileArtifactValue cachedValue=cachedTreeArtifactFileData.get(file);
    if (cachedValue == null) {
      FileValue fileValue=outputArtifactFileData.get(file);
      if (fileValue == null) {
        fileValue=constructFileValue(file,null);
        maybeStoreAdditionalData(file,fileValue,null);
      }
      cachedValue=Preconditions.checkNotNull(cachedTreeArtifactFileData.get(file),file);
    }
    values.put(file.getParentRelativePath(),cachedValue);
  }
  return TreeArtifactValue.create(values);
}
