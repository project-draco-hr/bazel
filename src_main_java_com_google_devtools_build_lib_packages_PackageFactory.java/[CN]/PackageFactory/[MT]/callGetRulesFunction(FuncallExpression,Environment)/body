{
  PackageContext context=getContext(env,ast);
  Collection<Target> targets=context.pkgBuilder.getTargets();
  Map<String,Map<String,Object>> rules=new TreeMap<>();
  for (  Target t : targets) {
    if (t instanceof Rule) {
      Map<String,Object> m=targetDict(t);
      Preconditions.checkNotNull(m);
      rules.put(t.getName(),m);
    }
  }
  return rules;
}
