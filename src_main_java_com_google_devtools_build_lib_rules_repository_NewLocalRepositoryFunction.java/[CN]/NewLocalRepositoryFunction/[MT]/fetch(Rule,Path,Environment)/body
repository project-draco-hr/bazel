{
  FileValue buildFileValue=getBuildFileValue(rule,env);
  if (env.valuesMissing()) {
    return null;
  }
  prepareLocalRepositorySymlinkTree(rule,outputDirectory);
  PathFragment pathFragment=getTargetPath(rule,getWorkspace());
  if (!symlinkLocalRepositoryContents(outputDirectory,getOutputBase().getFileSystem().getPath(pathFragment),env)) {
    return null;
  }
  return symlinkBuildFile(buildFileValue,outputDirectory);
}
