{
  Preconditions.checkNotNull(parameterFile);
  if (commandLine != null && arguments != null && !Iterables.isEmpty(arguments)) {
    throw new IllegalStateException("must provide either commandLine or arguments: " + arguments);
  }
  CommandLine paramFileContents=(commandLine != null) ? commandLine : CommandLine.ofInternal(arguments,false);
  requiredActions.add(new ParameterFileWriteAction(owner,parameterFile,paramFileContents,paramFileInfo.getFileType(),paramFileInfo.getCharset()));
  String pathWithFlag=paramFileInfo.getFlag() + parameterFile.getExecPathString();
  Iterable<String> commandArgv=Iterables.concat(executableArgs,ImmutableList.of(pathWithFlag));
  return CommandLine.ofInternal(commandArgv,isShellCommand);
}
