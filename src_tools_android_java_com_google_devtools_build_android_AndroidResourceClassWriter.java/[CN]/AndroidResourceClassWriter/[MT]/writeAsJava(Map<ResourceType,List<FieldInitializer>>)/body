{
  String packageDir=packageName.replace('.','/');
  Path packagePath=outputBasePath.resolve(packageDir);
  Path rJavaPath=packagePath.resolve(SdkConstants.FN_RESOURCE_CLASS);
  Files.createDirectories(rJavaPath.getParent());
  try (BufferedWriter writer=Files.newBufferedWriter(rJavaPath,UTF_8)){
    writer.write("/* AUTO-GENERATED FILE.  DO NOT MODIFY.\n");
    writer.write(" *\n");
    writer.write(" * This class was automatically generated by the\n");
    writer.write(" * bazel tool from the resource data it found.  It\n");
    writer.write(" * should not be modified by hand.\n");
    writer.write(" */\n");
    writer.write(String.format("package %s;\n",packageName));
    writer.write("public final class R {\n");
    for (    Map.Entry<ResourceType,Set<String>> fieldEntries : innerClasses.entrySet()) {
      ResourceType type=fieldEntries.getKey();
      writer.write(String.format("    public static final class %s {\n",type.getName()));
      for (      FieldInitializer field : initializers.get(type)) {
        field.writeInitSource(writer);
      }
      writer.write("    }\n");
    }
    writer.write("}");
  }
 }
