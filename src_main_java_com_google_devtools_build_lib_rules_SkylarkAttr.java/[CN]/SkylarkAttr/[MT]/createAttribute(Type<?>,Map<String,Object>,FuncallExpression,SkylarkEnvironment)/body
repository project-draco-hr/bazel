{
  Attribute.Builder<?> builder=Attribute.attr("",type);
  Object defaultValue=arguments.get("default");
  if (!EvalUtils.isNullOrNone(defaultValue)) {
    if (defaultValue instanceof UserDefinedFunction) {
      builder.value(new SkylarkLateBound(new SkylarkCallbackFunction((UserDefinedFunction)defaultValue,ast,env)));
    }
 else {
      builder.defaultValue(defaultValue);
    }
  }
  for (  String flag : castList(arguments.get("flags"),String.class)) {
    builder.setPropertyFlag(flag);
  }
  if (containsNonNoneKey(arguments,"mandatory") && (Boolean)arguments.get("mandatory")) {
    builder.setPropertyFlag("MANDATORY");
  }
  if (containsNonNoneKey(arguments,"non_empty") && (Boolean)arguments.get("non_empty")) {
    builder.setPropertyFlag("NON_EMPTY");
  }
  if (containsNonNoneKey(arguments,"executable") && (Boolean)arguments.get("executable")) {
    builder.setPropertyFlag("EXECUTABLE");
  }
  if (containsNonNoneKey(arguments,"single_file") && (Boolean)arguments.get("single_file")) {
    builder.setPropertyFlag("SINGLE_ARTIFACT");
  }
  if (containsNonNoneKey(arguments,"allow_files")) {
    Object fileTypesObj=arguments.get("allow_files");
    if (fileTypesObj == Boolean.TRUE) {
      builder.allowedFileTypes(FileTypeSet.ANY_FILE);
    }
 else     if (fileTypesObj == Boolean.FALSE) {
      builder.allowedFileTypes(FileTypeSet.NO_FILE);
    }
 else     if (fileTypesObj instanceof SkylarkFileType) {
      builder.allowedFileTypes(((SkylarkFileType)fileTypesObj).getFileTypeSet());
    }
 else {
      throw new EvalException(ast.getLocation(),"allow_files should be a boolean or a filetype object.");
    }
  }
 else   if (type.equals(Type.LABEL) || type.equals(Type.LABEL_LIST)) {
    builder.allowedFileTypes(FileTypeSet.NO_FILE);
  }
  Object ruleClassesObj=arguments.get("allow_rules");
  if (ruleClassesObj != null && ruleClassesObj != Environment.NONE) {
    builder.allowedRuleClasses(castList(ruleClassesObj,String.class,"allowed rule classes for attribute definition"));
  }
  if (containsNonNoneKey(arguments,"providers")) {
    builder.mandatoryProviders(castList(arguments.get("providers"),String.class));
  }
  if (containsNonNoneKey(arguments,"cfg")) {
    builder.cfg((ConfigurationTransition)arguments.get("cfg"));
  }
  return builder;
}
