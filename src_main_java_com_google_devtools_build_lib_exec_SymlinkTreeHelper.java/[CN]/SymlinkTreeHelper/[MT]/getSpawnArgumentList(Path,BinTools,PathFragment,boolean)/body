{
  PathFragment path=binTools.getExecPath(BUILD_RUNFILES);
  Preconditions.checkNotNull(path,BUILD_RUNFILES + " not found in embedded tools");
  List<String> args=Lists.newArrayList();
  if (OS.getCurrent() == OS.WINDOWS) {
    args.add(shExecutable.getPathString());
    args.add("-c");
    args.add("$0 $*");
  }
  args.add(execRoot.getRelative(path).getPathString());
  if (filesetTree) {
    args.add("--allow_relative");
    args.add("--use_metadata");
  }
  FileSystem fs=execRoot.getFileSystem();
  if ((fs instanceof WindowsFileSystem) || (fs instanceof UnixFileSystem && ((UnixFileSystem)fs).getSymlinkStrategy() == SymlinkStrategy.WINDOWS_COMPATIBLE)) {
    args.add("--windows_compatible");
  }
  if (!enableRunfiles) {
    args.add("--manifest_only");
  }
  args.add(inputManifest.getPathString());
  args.add(symlinkTreeRoot.getPathString());
  return args;
}
