{
  if (environmentBuilder != null) {
    Environment workspaceEnv=environmentBuilder.setLoadingPhase().build();
    addWorkspaceFunctions(workspaceEnv);
    if (!buildFileAST.exec(workspaceEnv,localReporter)) {
      localReporter.handle(Event.error("Error evaluating WORKSPACE file " + source.getPath()));
    }
  }
  environmentBuilder=null;
  buildFileAST=null;
  source=null;
  builder.addEvents(localReporter.getEvents());
  if (localReporter.hasErrors()) {
    builder.setContainsErrors();
  }
  localReporter.clear();
}
