{
  if (result.hasError()) {
    boolean hasCycles=false;
    for (    Map.Entry<SkyKey,ErrorInfo> entry : result.errorMap().entrySet()) {
      Iterable<CycleInfo> cycles=entry.getValue().getCycleInfo();
      skyframeExecutor.reportCycles(eventHandler,cycles,entry.getKey());
      hasCycles|=!Iterables.isEmpty(cycles);
    }
    boolean hasCatastrophe=resultHasCatastrophicError(result);
    if (keepGoing && !hasCatastrophe) {
      return false;
    }
    if (hasCycles || result.errorMap().isEmpty()) {
      if (result.getCatastrophe() != null) {
        rethrow(result.getCatastrophe());
      }
      throw new BuildFailedException(null,hasCatastrophe);
    }
 else {
      rethrow(Preconditions.checkNotNull(result.getError().getException()));
    }
  }
  return true;
}
