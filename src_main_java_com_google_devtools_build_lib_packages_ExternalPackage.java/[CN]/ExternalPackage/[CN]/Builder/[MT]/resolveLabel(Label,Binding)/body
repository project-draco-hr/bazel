{
  Label actual=binding.getActual();
  if (actual == null) {
    return;
  }
  Label tortoise=virtual;
  Label hare=actual;
  boolean moveTortoise=true;
  while (Binding.isBoundLabel(actual)) {
    if (tortoise == hare) {
      throw new NoSuchBindingException("cycle detected resolving " + virtual + " binding",binding.getLocation());
    }
    Label previous=actual;
    Binding oldBinding=binding;
    binding=bindMap.get(actual);
    if (binding == null) {
      throw new NoSuchBindingException("no binding found for target " + previous + " (via "+ virtual+ ")",oldBinding.getLocation());
    }
    actual=binding.getActual();
    hare=actual;
    moveTortoise=!moveTortoise;
    if (moveTortoise) {
      tortoise=bindMap.get(tortoise).getActual();
    }
  }
  bindMap.put(virtual,binding);
}
