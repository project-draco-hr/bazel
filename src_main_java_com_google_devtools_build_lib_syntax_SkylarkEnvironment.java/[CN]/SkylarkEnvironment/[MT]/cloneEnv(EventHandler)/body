{
  Preconditions.checkArgument(isGlobalEnvironment());
  SkylarkEnvironment newEnv=new SkylarkEnvironment(eventHandler,this.fileContentHashCode);
  for (  Entry<String,Object> entry : env.entrySet()) {
    newEnv.env.put(entry.getKey(),entry.getValue());
  }
  for (  Map.Entry<Class<?>,Map<String,Function>> functionMap : functions.entrySet()) {
    newEnv.functions.put(functionMap.getKey(),functionMap.getValue());
  }
  return newEnv;
}
