{
  if (sourceOut != null && variantType != VariantConfiguration.Type.LIBRARY && !libraries.isEmpty()) {
    SymbolLoader fullSymbolValues=null;
    String appPackageName=customPackageForR;
    if (appPackageName == null) {
      appPackageName=VariantConfiguration.getManifestPackage(androidManifest);
    }
    Multimap<String,SymbolLoader> libMap=ArrayListMultimap.create();
    for (    SymbolFileProvider lib : libraries) {
      String packageName=VariantConfiguration.getManifestPackage(lib.getManifest());
      if (appPackageName.equals(packageName)) {
        continue;
      }
      File rFile=lib.getSymbolFile();
      if (rFile.isFile()) {
        if (fullSymbolValues == null) {
          fullSymbolValues=new SymbolLoader(sourceOut.resolve("R.txt").toFile(),stdLogger);
          fullSymbolValues.load();
        }
        SymbolLoader libSymbols=new SymbolLoader(rFile,stdLogger);
        libSymbols.load();
        libMap.put(packageName,libSymbols);
      }
    }
    for (    String packageName : libMap.keySet()) {
      Collection<SymbolLoader> symbols=libMap.get(packageName);
      SymbolWriter writer=new SymbolWriter(sourceOut.toString(),packageName,fullSymbolValues);
      for (      SymbolLoader symbolLoader : symbols) {
        writer.addSymbolsToWrite(symbolLoader);
      }
      writer.write();
    }
  }
}
