{
  File buildEncyclopediaPath=setupDirectories(outputRootDir);
  Page page=TemplateEngine.newPage("com/google/devtools/build/docgen/templates/build-encyclopedia.vm");
  BuildDocCollector collector=new BuildDocCollector(ruleClassProvider,false);
  Map<String,RuleDocumentation> ruleDocEntries=collector.collect(inputDirs,blackList);
  warnAboutUndocumentedRules(Sets.difference(ruleClassProvider.getRuleClassMap().keySet(),ruleDocEntries.keySet()));
  writeRuleClassDocs(ruleDocEntries.values(),page);
  page.write(buildEncyclopediaPath);
}
