{
  BufferedWriter bw=null;
  File buildEncyclopediaPath=setupDirectories(outputRootDir);
  try {
    bw=new BufferedWriter(new FileWriter(buildEncyclopediaPath));
    bw.write(DocgenConsts.HEADER_COMMENT);
    Set<RuleDocumentation> ruleDocEntries=collectAndProcessRuleDocs(inputDirs,false);
    writeRuleClassDocs(ruleDocEntries,bw);
    bw.write(SourceFileReader.readTemplateContents(DocgenConsts.FOOTER_TEMPLATE));
  }
  finally {
    if (bw != null) {
      bw.close();
    }
  }
}
