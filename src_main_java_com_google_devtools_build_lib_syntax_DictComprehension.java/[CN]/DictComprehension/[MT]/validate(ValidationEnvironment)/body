{
  SkylarkType elementsType=listExpression.validate(env);
  SkylarkType listElementType=SkylarkType.getGenericArgType(elementsType);
  env.update(loopVar.getName(),listElementType,getLocation());
  SkylarkType keyType=keyExpression.validate(env);
  if (!keyType.isSimple()) {
    throw new EvalException(getLocation(),"Dict comprehension key must be of a simple type");
  }
  valueExpression.validate(env);
  if (elementsType != SkylarkType.UNKNOWN && !elementsType.isList()) {
    throw new EvalException(getLocation(),"Dict comprehension elements must be a list");
  }
  return SkylarkType.of(SkylarkType.MAP,keyType);
}
