{
  setupJavaPythonCcConfigurationFiles();
  ConfiguredTarget ccRuleA=getConfiguredTarget("//foo:a");
  List<Artifact> middleman1=getAggregatingMiddleman(ccRuleA,true);
  try {
    ConfiguredTarget ccRuleB=getConfiguredTarget("//foo:b");
    getAggregatingMiddleman(ccRuleB,true);
    analysisEnvironment.registerWith(getMutableActionGraph());
    fail("Expected ActionConflictException due to same middleman artifact with different files");
  }
 catch (  UncheckedActionConflictException e) {
  }
  ConfiguredTarget pyRuleC=getConfiguredTarget("//foo:c");
  List<Artifact> middleman2=getAggregatingMiddleman(pyRuleC,true);
  assertEquals(Iterables.getOnlyElement(middleman1).getExecPathString(),Iterables.getOnlyElement(middleman2).getExecPathString());
}
