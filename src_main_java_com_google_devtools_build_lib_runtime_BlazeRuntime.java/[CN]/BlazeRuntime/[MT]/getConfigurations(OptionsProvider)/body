{
  BuildOptions buildOptions=createBuildOptions(optionsProvider);
  boolean keepGoing=optionsProvider.getOptions(BuildView.Options.class).keepGoing;
  LoadedPackageProvider loadedPackageProvider=loadingPhaseRunner.loadForConfigurations(reporter,ImmutableSet.copyOf(buildOptions.getAllLabels().values()),keepGoing);
  if (loadedPackageProvider == null) {
    throw new InvalidConfigurationException("Configuration creation failed");
  }
  return skyframeExecutor.createConfigurations(configurationFactory,buildOptions,directories,ImmutableSet.<String>of(),keepGoing);
}
