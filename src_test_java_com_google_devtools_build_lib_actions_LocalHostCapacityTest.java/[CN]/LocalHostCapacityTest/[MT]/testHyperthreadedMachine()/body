{
  String cpuinfoContent=StringUtilities.joinLines("processor\t: 0","vendor_id\t: GenuineIntel","cpu family\t: 15","model\t\t: 4","model name\t:               Intel(R) Pentium(R) 4 CPU 3.40GHz","stepping\t: 1","cpu MHz\t\t: 3400.245","cache size\t: 1024 KB","physical id\t: 0","siblings\t: 2","core id\t\t: 0","cpu cores\t: 1","fpu\t\t: yes","fpu_exception\t: yes","cpuid level\t: 5","wp\t\t: yes","flags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge " + "mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm " + "syscall lm constant_tsc pni monitor ds_cpl cid cx16 xtpr","bogomips\t: 6806.31","clflush size\t: 64","cache_alignment\t: 128","address sizes\t: 36 bits physical, 48 bits virtual","power management:","","processor\t: 1","vendor_id\t: GenuineIntel","cpu family\t: 15","model\t\t: 4","model name\t:               Intel(R) Pentium(R) 4 CPU 3.40GHz","stepping\t: 1","cpu MHz\t\t: 3400.245","cache size\t: 1024 KB","physical id\t: 0","siblings\t: 2","core id\t\t: 0","cpu cores\t: 1","fpu\t\t: yes","fpu_exception\t: yes","cpuid level\t: 5","wp\t\t: yes","flags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge " + "mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm " + "syscall lm constant_tsc pni monitor ds_cpl cid cx16 xtpr","bogomips\t: 6800.76","clflush size\t: 64","cache_alignment\t: 128","address sizes\t: 36 bits physical, 48 bits virtual","power management:","");
  String cpuinfoFile=scratch.file("test_cpuinfo_ht",cpuinfoContent).getPathString();
  String meminfoContent=StringUtilities.joinLines("MemTotal:      3092004 kB","MemFree:         26124 kB","Buffers:          3836 kB","Cached:          52400 kB","SwapCached:      68204 kB","Active:        2281464 kB","Inactive:       260908 kB","HighTotal:           0 kB","HighFree:            0 kB","LowTotal:      3092004 kB","LowFree:         26124 kB","SwapTotal:     9124880 kB","SwapFree:      8264920 kB","Dirty:             616 kB","Writeback:           0 kB","AnonPages:     2466336 kB","Mapped:          37576 kB","Slab:           483004 kB","PageTables:      11912 kB","NFS_Unstable:        0 kB","Bounce:              0 kB","CommitLimit:  10670880 kB","Committed_AS:  3627984 kB","VmallocTotal: 34359738367 kB","VmallocUsed:    300460 kB","VmallocChunk: 34359437307 kB","HugePages_Total:     0","HugePages_Free:      0","HugePages_Rsvd:      0","Hugepagesize:     2048 kB");
  String meminfoFile=scratch.file("test_meminfo_ht",meminfoContent).getPathString();
  assertEquals(2,LocalHostCapacity.getLogicalCpuCount(cpuinfoContent));
  assertEquals(1,LocalHostCapacity.getPhysicalCpuCount(cpuinfoContent,2));
  assertEquals(1,LocalHostCapacity.getCoresPerCpu(cpuinfoContent));
  ResourceSet capacity=LocalHostCapacity.getLocalHostCapacity(cpuinfoFile,meminfoFile);
  assertEquals(1.2,capacity.getCpuUsage(),.0001);
  assertEquals(3092.004,capacity.getMemoryMb(),0.1);
}
