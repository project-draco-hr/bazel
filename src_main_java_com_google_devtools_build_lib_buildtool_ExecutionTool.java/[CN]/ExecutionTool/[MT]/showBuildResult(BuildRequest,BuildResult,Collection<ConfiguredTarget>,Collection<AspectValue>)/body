{
  Collection<ConfiguredTarget> succeeded=new ArrayList<>();
  Collection<ConfiguredTarget> failed=new ArrayList<>();
  for (  ConfiguredTarget target : configuredTargets) {
    if (target instanceof InputFileConfiguredTarget) {
      continue;
    }
    if (target.getTarget() instanceof Rule) {
      Rule rule=(Rule)target.getTarget();
      if (rule.getRuleClass().contains("$")) {
        continue;
      }
    }
    if (target instanceof OutputFileConfiguredTarget) {
      TransitiveInfoCollection generatingRule=env.getView().getGeneratingRule((OutputFileConfiguredTarget)target);
      if (CollectionUtils.containsAll(generatingRule.getProvider(FileProvider.class).getFilesToBuild(),target.getProvider(FileProvider.class).getFilesToBuild()) && configuredTargets.contains(generatingRule)) {
        continue;
      }
    }
    Collection<ConfiguredTarget> successfulTargets=result.getSuccessfulTargets();
    (successfulTargets.contains(target) ? succeeded : failed).add(target);
  }
  if (succeeded.size() + failed.size() + aspects.size() > request.getBuildOptions().maxResultTargets) {
    return;
  }
  OutErr outErr=request.getOutErr();
  ArtifactFormatter formatter=request.getBuildOptions().detailedResult ? new DetailedArtifactFormatter() : new BriefArtifactFormatter();
  TopLevelArtifactContext context=request.getTopLevelArtifactContext();
  for (  ConfiguredTarget target : succeeded) {
    Label label=target.getLabel();
    boolean headerFlag=true;
    for (    Artifact artifact : TopLevelArtifactHelper.getAllArtifactsToBuild(target,context).getImportantArtifacts()) {
      if (formatter.shouldPrint(artifact)) {
        if (headerFlag) {
          outErr.printErr("Target " + label + " up-to-date:\n");
          headerFlag=false;
        }
        outErr.printErrLn(formatter.format(artifact));
      }
    }
    if (headerFlag) {
      outErr.printErr("Target " + label + " up-to-date (nothing to build)\n");
    }
  }
  for (  AspectValue aspect : aspects) {
    Label label=aspect.getLabel();
    String aspectName=aspect.getAspect().getName();
    boolean headerFlag=true;
    NestedSet<Artifact> importantArtifacts=TopLevelArtifactHelper.getAllArtifactsToBuild(aspect,context).getImportantArtifacts();
    for (    Artifact importantArtifact : importantArtifacts) {
      if (headerFlag) {
        outErr.printErr("Aspect " + aspectName + " of "+ label+ " up-to-date:\n");
        headerFlag=false;
      }
      if (formatter.shouldPrint(importantArtifact)) {
        outErr.printErrLn(formatter.format(importantArtifact));
      }
    }
    if (headerFlag) {
      outErr.printErr("Aspect " + aspectName + " of "+ label+ " up-to-date (nothing to build)\n");
    }
  }
  for (  ConfiguredTarget target : failed) {
    outErr.printErr("Target " + target.getLabel() + " failed to build\n");
    OutputGroupProvider topLevelProvider=target.getProvider(OutputGroupProvider.class);
    if (topLevelProvider != null) {
      for (      Artifact temp : topLevelProvider.getOutputGroup(OutputGroupProvider.TEMP_FILES)) {
        if (temp.getPath().exists()) {
          outErr.printErrLn("  See temp at " + OutputDirectoryLinksUtils.getPrettyPath(temp.getPath(),runtime.getWorkspaceName(),getWorkspace(),request.getSymlinkPrefix()));
        }
      }
    }
  }
  if (!failed.isEmpty() && !request.getOptions(ExecutionOptions.class).verboseFailures) {
    outErr.printErr("Use --verbose_failures to see the command lines of failed build steps.\n");
  }
}
