{
  SkyframeTargetPatternEvaluator patternEvaluator=(SkyframeTargetPatternEvaluator)packageManager.getTargetPatternEvaluator();
  String offset=patternEvaluator.getOffset();
  FilteringPolicy policy=TargetPatternEvaluator.DEFAULT_FILTERING_POLICY;
  SkyKey skyKey=PrepareDepsOfPatternsValue.key(ImmutableList.copyOf(patterns),policy,offset);
  EvaluationResult<SkyValue> evaluationResult=buildDriver.evaluate(ImmutableList.of(skyKey),true,numThreads,eventHandler);
  return Preconditions.checkNotNull(evaluationResult.getWalkableGraph(),patterns);
}
