{
  Set<Target> result=new HashSet<>();
  for (  Label label : labels) {
    try {
      result.add(packageManager.getLoadedTarget(label));
    }
 catch (    NoSuchPackageException e) {
      Package pkg=Preconditions.checkNotNull(e.getPackage());
      try {
        result.add(pkg.getTarget(label.getName()));
      }
 catch (      NoSuchTargetException ex) {
        throw new IllegalStateException(ex);
      }
    }
catch (    NoSuchThingException e) {
      throw new IllegalStateException(e);
    }
  }
  return result;
}
