{
  List<Artifact> instrumentedObjectFiles=new ArrayList<>();
  instrumentedObjectFiles.addAll(ccCompilationOutputs.getObjectFiles(false));
  instrumentedObjectFiles.addAll(ccCompilationOutputs.getObjectFiles(true));
  builder.setFilesToBuild(filesToBuild).add(CppCompilationContext.class,cppCompilationContext).add(TransitiveLipoInfoProvider.class,transitiveLipoInfo).add(CcExecutionDynamicLibrariesProvider.class,new CcExecutionDynamicLibrariesProvider(collectExecutionDynamicLibraryArtifacts(ruleContext,linkingOutputs.getExecutionDynamicLibraries()))).add(CcNativeLibraryProvider.class,new CcNativeLibraryProvider(collectTransitiveCcNativeLibraries(ruleContext,linkingOutputs.getDynamicLibraries()))).add(InstrumentedFilesProvider.class,getInstrumentedFilesProvider(instrumentedObjectFiles)).add(TempsProvider.class,new TempsProvider(getTemps(ccCompilationOutputs))).add(CppDebugFileProvider.class,new CppDebugFileProvider(dwoArtifacts.getDwoArtifacts(),dwoArtifacts.getPicDwoArtifacts())).addOutputGroup(TopLevelArtifactProvider.FILES_TO_COMPILE,NestedSetBuilder.wrap(Order.STABLE_ORDER,getFilesToCompile(ccCompilationOutputs))).addOutputGroup(TopLevelArtifactProvider.COMPILATION_PREREQUISITES,collectCompilationPrerequisites(ruleContext,cppCompilationContext));
}
