{
  BlazeRuntime runtime=env.getRuntime();
  String commandName=options.getOptions(Options.class).forCommand;
  BlazeCommand command=runtime.getCommandMap().get(commandName);
  if (command == null) {
    env.getReporter().handle(Event.error("Not a valid command: '" + commandName + "' (should be one of "+ Joiner.on(", ").join(runtime.getCommandMap().keySet())+ ")"));
    return ExitCode.COMMAND_LINE_ERROR;
  }
  Collection<Class<? extends OptionsBase>> optionsClasses=BlazeCommandUtils.getOptions(command.getClass(),runtime.getBlazeModules(),runtime.getRuleClassProvider());
  try {
    List<String> result=OptionsParser.canonicalize(optionsClasses,options.getResidue());
    for (    String piece : result) {
      env.getReporter().getOutErr().printOutLn(piece);
    }
  }
 catch (  OptionsParsingException e) {
    env.getReporter().handle(Event.error(e.getMessage()));
    return ExitCode.COMMAND_LINE_ERROR;
  }
  return ExitCode.SUCCESS;
}
