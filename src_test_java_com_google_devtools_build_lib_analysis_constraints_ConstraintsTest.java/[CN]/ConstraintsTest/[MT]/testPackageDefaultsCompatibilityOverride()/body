{
  new EnvironmentGroupMaker("foo_env").setEnvironments("a","b").setDefaults().make();
  scratch.file("hello/BUILD","package(default_compatible_with = ['//foo_env:b'])",getDependencyRule(compatibleWith("//foo_env:a")),getDependingRule(compatibleWith("//foo_env:a","//foo_env:b")));
  reporter.removeHandler(failFastHandler);
  assertNull(getConfiguredTarget("//hello:main"));
  assertContainsEvent("dependency //hello:dep doesn't support expected environment: //foo_env:b");
}
