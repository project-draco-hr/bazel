{
  new EnvironmentGroupMaker("foo_env").setEnvironments("a","b","c").setDefaults("a","b").make();
  scratchFile("hello/BUILD",getDependencyRule(),getDependingRule(constrainedTo("//foo_env:c")));
  reporter.removeHandler(failFastHandler);
  assertNull(getConfiguredTarget("//hello:main"));
  assertContainsEvent("dependency //hello:dep doesn't support expected environment: //foo_env:c");
}
