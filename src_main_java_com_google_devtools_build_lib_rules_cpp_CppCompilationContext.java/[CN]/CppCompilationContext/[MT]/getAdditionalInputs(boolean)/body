{
  if (depsContexts.isEmpty()) {
    return NestedSetBuilder.emptySet(Order.STABLE_ORDER);
  }
  NestedSetBuilder<Artifact> builder=NestedSetBuilder.stableOrder();
  for (  DepsContext depsContext : depsContexts) {
    if (useHeaderModules) {
      if (usePic) {
        builder.addTransitive(depsContext.picTopLevelHeaderModules);
        builder.addTransitive(depsContext.picImpliedHeaderModules);
      }
 else {
        builder.addTransitive(depsContext.topLevelHeaderModules);
        builder.addTransitive(depsContext.impliedHeaderModules);
      }
    }
    builder.addTransitive(depsContext.directModuleMaps);
    if (provideTransitiveModuleMaps) {
      builder.addTransitive(depsContext.transitiveModuleMaps);
    }
  }
  if (cppModuleMap != null) {
    builder.add(cppModuleMap.getArtifact());
  }
  return builder.build();
}
