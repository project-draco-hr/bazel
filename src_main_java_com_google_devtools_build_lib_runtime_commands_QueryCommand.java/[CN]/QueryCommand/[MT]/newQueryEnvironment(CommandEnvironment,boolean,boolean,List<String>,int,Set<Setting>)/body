{
  ImmutableList.Builder<QueryFunction> functions=ImmutableList.builder();
  for (  BlazeModule module : env.getRuntime().getBlazeModules()) {
    functions.addAll(module.getQueryFunctions());
  }
  return AbstractBlazeQueryEnvironment.newQueryEnvironment(env.getPackageManager().newTransitiveLoader(),env.getSkyframeExecutor(),env.getPackageManager(),env.getPackageManager().getTargetPatternEvaluator(),keepGoing,orderedResults,universeScope,loadingPhaseThreads,env.getReporter(),settings,functions.build(),env.getPackageManager().getPackagePath());
}
