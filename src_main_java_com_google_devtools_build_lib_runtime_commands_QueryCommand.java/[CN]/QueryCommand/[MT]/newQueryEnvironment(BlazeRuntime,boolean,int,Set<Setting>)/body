{
  ImmutableList.Builder<QueryFunction> functions=ImmutableList.builder();
  for (  BlazeModule module : runtime.getBlazeModules()) {
    functions.addAll(module.getQueryFunctions());
  }
  return new SkyframeQueryEnvironment(runtime.getPackageManager().newTransitiveLoader(),runtime.getPackageManager(),runtime.getTargetPatternEvaluator(),keepGoing,loadingPhaseThreads,runtime.getReporter(),settings,functions.build());
}
