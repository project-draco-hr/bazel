{
  if (isFile && digest == null) {
    digest=DigestUtils.getDigestOrFail(artifact.getPath(),size);
  }
  if (!DigestUtils.useFileDigest(artifact,isFile,size)) {
    return new FileArtifactValue(digest,artifact.getPath().getLastModifiedTime(),size);
  }
  Preconditions.checkState(digest != null,artifact);
  return new FileArtifactValue(digest,size);
}
