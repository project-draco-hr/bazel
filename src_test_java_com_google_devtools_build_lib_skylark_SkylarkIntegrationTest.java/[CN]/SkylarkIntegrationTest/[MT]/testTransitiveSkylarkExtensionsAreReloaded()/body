{
  createSimpleExtension("'a'",false);
  scratch.file("test/skylark/extension2.bzl","load('/test/skylark/extension', 'custom_rule')","custom_rule_2 = custom_rule");
  scratch.file("test/skylark/BUILD","load('/test/skylark/extension2', 'custom_rule_2')","","custom_rule_2(name = 'cr')");
  assertEquals("a",getConfiguredTarget("//test/skylark:cr").get("provider"));
  createSimpleExtension("'b'",true);
  invalidatePackages();
  assertEquals("b",getConfiguredTarget("//test/skylark:cr").get("provider"));
}
