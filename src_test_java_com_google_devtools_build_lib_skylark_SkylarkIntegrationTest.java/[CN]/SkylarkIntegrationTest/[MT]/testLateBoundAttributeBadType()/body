{
  scratch.file("test/skylark/extension.bzl","def custom_rule_impl(ctx): pass","","def attr_value(attr_map, cfg): return 5","","custom_rule = rule(implementation = custom_rule_impl,","  attrs = {'_attr': attr.label(default=attr_value)})");
  checkError("test/skylark","cr","When computing the default value of :attr, expected 'label', got 'int'","load('/test/skylark/extension', 'custom_rule')","","custom_rule(name = 'cr')");
}
