{
  scratch.file("test/skylark/extension.bzl","def custom_rule_impl(ctx):","  native.genrule(name = 'some_genrule',","    outs = ['out.txt'],","    cmd = 'echo hello >@')","  return struct()","","custom_rule = rule(implementation = custom_rule_impl)");
  checkError("test/skylark","cr","genrule() can only be called during the loading phase","load('/test/skylark/extension', 'custom_rule')","custom_rule(name = 'cr')");
}
