{
  ImmutableList<String> actualLinkstampCompileOptions;
  if (linkstampCompileOptions.isEmpty()) {
    actualLinkstampCompileOptions=DEFAULT_LINKSTAMP_OPTIONS;
  }
 else {
    actualLinkstampCompileOptions=ImmutableList.copyOf(Iterables.concat(DEFAULT_LINKSTAMP_OPTIONS,linkstampCompileOptions));
  }
  CcToolchainFeatures.Variables variables=null;
  if (ruleContext != null) {
    if (featureConfiguration == null) {
      if (toolchain != null) {
        featureConfiguration=CcCommon.configureFeatures(ruleContext,toolchain,CcLibraryHelper.SourceCategory.CC);
      }
 else {
        featureConfiguration=CcCommon.configureFeatures(ruleContext);
      }
    }
    CcToolchainFeatures.Variables.Builder buildVariables=new CcToolchainFeatures.Variables.Builder();
    CppHelper.getFdoSupport(ruleContext).getLinkOptions(featureConfiguration,buildVariables);
    variables=buildVariables.build();
  }
  return new LinkCommandLine(actionName,configuration,owner,output,interfaceOutput,symbolCountsOutput,buildInfoHeaderArtifacts,linkerInputs,runtimeInputs,linkTargetType,linkStaticness,linkopts,features,linkstamps,actualLinkstampCompileOptions,CppHelper.getFdoBuildStamp(ruleContext),runtimeSolibDir,nativeDeps,useTestOnlyFlags,needWholeArchive,allLTOBackendArtifacts,paramFile,interfaceSoBuilder,variables,featureConfiguration);
}
