{
  for (  Node<Class<? extends RuleDefinition>> ruleDefinition : dependencyGraph.getTopologicalOrder()) {
    commitRuleDefinition(ruleDefinition.getLabel());
  }
  return new ConfiguredRuleClassProvider(preludePath,ImmutableMap.copyOf(ruleClassMap),ImmutableMap.copyOf(ruleDefinitionMap),ImmutableMap.copyOf(aspectFactoryMap),defaultWorkspaceFile.toString(),ImmutableList.copyOf(buildInfoFactories),ImmutableList.copyOf(configurationOptions),ImmutableList.copyOf(configurationFragments),configurationCollectionFactory,prerequisiteValidator,skylarkAccessibleJavaClasses);
}
