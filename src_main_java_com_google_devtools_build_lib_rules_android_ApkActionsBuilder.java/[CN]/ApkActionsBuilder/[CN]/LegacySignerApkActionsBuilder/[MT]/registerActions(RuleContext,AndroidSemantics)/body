{
  Preconditions.checkNotNull(apkName,"APK name must be set to create progress messages for APK actions.");
  if (unsignedApk != null) {
    ruleContext.registerAction(buildApk(ruleContext,unsignedApk,null,"Generating unsigned " + apkName));
  }
  if (signedAndZipalignedApk != null) {
    Artifact intermediateSignedApk=this.signedApk;
    if (intermediateSignedApk == null) {
      intermediateSignedApk=AndroidBinary.getDxArtifact(ruleContext,"signed_" + signedAndZipalignedApk.getFilename());
    }
    ruleContext.registerAction(buildApk(ruleContext,intermediateSignedApk,semantics.getApkDebugSigningKey(ruleContext),"Generating signed " + apkName));
    ruleContext.registerAction(zipalignApk(ruleContext,intermediateSignedApk,signedAndZipalignedApk));
  }
 else   if (signedApk != null) {
    ruleContext.registerAction(buildApk(ruleContext,signedApk,semantics.getApkDebugSigningKey(ruleContext),"Generating signed " + apkName));
  }
}
