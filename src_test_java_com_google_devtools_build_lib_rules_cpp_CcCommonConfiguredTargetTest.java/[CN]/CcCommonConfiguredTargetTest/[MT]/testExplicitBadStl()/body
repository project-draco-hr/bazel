{
  scratch.file("x/BUILD","cc_binary(name = 'x', srcs = ['x.cc'])");
  reporter.removeHandler(failFastHandler);
  try {
    useConfiguration("--experimental_stl=//x:blah");
    update(Arrays.asList("//x:x"),true,10,false,new EventBus());
    fail("found non-existing target");
  }
 catch (  LoadingFailedException expected) {
    assertThat(expected.getMessage()).contains("Failed to load required STL target: '//x:blah'");
  }
  try {
    useConfiguration("--experimental_stl=//blah");
    update(Arrays.asList("//x:x"),true,10,false,new EventBus());
    fail("found non-existsing target");
  }
 catch (  LoadingFailedException expected) {
    assertThat(expected.getMessage()).contains("Failed to load required STL target: '//blah:blah'");
  }
  try {
    useConfiguration("--experimental_stl=//blah");
    update(Arrays.asList("//x:x"),false,10,false,new EventBus());
    fail("found non-existsing target");
  }
 catch (  LoadingFailedException expected) {
    assertThat(expected.getMessage()).contains("Loading failed; build aborted");
  }
}
