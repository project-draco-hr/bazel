def testXMLOutput(self):
    gflags.DEFINE_string('unicode1', '\xc3\x80\xc3\xbd'.decode('utf-8'), 'help:\xc3\xac'.decode('utf-8'))
    gflags.DEFINE_list('unicode2', ['abc', '\xc3\x80'.decode('utf-8'), '\xc3\xbd'.decode('utf-8')], 'help:\xc3\xad'.decode('utf-8'))
    gflags.DEFINE_list('non_unicode', ['abc', 'def', 'ghi'], 'help:\xc3\xad'.decode('utf-8'))
    outfile = cStringIO.StringIO()
    FLAGS.WriteHelpInXMLFormat(outfile)
    actual_output = outfile.getvalue()
    self.assertTrue(('<name>unicode1</name>\n    <meaning>help:&#236;</meaning>\n    <default>&#192;&#253;</default>\n    <current>&#192;&#253;</current>' in actual_output))
    self.assertTrue(("<name>unicode2</name>\n    <meaning>help:&#237;</meaning>\n    <default>abc,&#192;,&#253;</default>\n    <current>['abc', u'\\xc0', u'\\xfd']</current>" in actual_output))
    self.assertTrue(("<name>non_unicode</name>\n    <meaning>help:&#237;</meaning>\n    <default>abc,def,ghi</default>\n    <current>['abc', 'def', 'ghi']</current>" in actual_output))
