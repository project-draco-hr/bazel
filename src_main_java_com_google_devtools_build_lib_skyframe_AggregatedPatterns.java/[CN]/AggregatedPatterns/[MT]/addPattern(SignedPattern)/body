{
  Preconditions.checkNotNull(signedPattern);
  String directoryWithoutTrailingSlash=signedPattern.getPattern().getDirectory();
  if (isTargetsBelowDirectory(signedPattern)) {
    getDirectoriesBelow(directoryWithoutTrailingSlash).clear();
  }
  String directoryKey=getDirectoryKey(directoryWithoutTrailingSlash);
  List<SignedPattern> patternsMaybe=orderedPatternsByDirectory.get(directoryKey);
  if (patternsMaybe == null) {
    patternsMaybe=Lists.newArrayList();
    orderedPatternsByDirectory.put(directoryKey,patternsMaybe);
  }
  patternsMaybe.add(signedPattern);
  return this;
}
