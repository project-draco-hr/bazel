{
  Executor executor=actionExecutionContext.getExecutor();
  if (executor.reportsSubcommands()) {
    executor.reportSubcommand(Label.print(spawn.getOwner().getLabel()) + " [" + spawn.getResourceOwner().prettyPrint()+ "]",spawn.asShellCommand(executor.getExecRoot()));
  }
  if (!incrementalHeuristic.shouldUseWorkers()) {
    standaloneStrategy.exec(spawn,actionExecutionContext);
    return;
  }
  if (!Iterables.getLast(spawn.getArguments()).startsWith("@")) {
    standaloneStrategy.exec(spawn,actionExecutionContext);
    return;
  }
  String paramFile=Iterables.getLast(spawn.getArguments());
  FileOutErr outErr=actionExecutionContext.getFileOutErr();
  ImmutableList<String> args=ImmutableList.<String>builder().addAll(spawn.getArguments().subList(0,spawn.getArguments().size() - 1)).add("--persistent_worker").build();
  ImmutableMap<String,String> env=spawn.getEnvironment();
  Path workDir=actionExecutionContext.getExecutor().getExecRoot();
  WorkerKey key=new WorkerKey(args,env,workDir,spawn.getMnemonic());
  try {
    WorkResponse response=execInWorker(executor.getEventHandler(),paramFile,key,maxRetries);
    outErr.getErrorStream().write(response.getOutputBytes().toByteArray());
    if (response.getExitCode() != 0) {
      throw new UserExecException(String.format("Worker process failed with exit code: %d.",response.getExitCode()));
    }
  }
 catch (  Exception e) {
    String message=CommandFailureUtils.describeCommandFailure(verboseFailures,spawn.getArguments(),env,workDir.getPathString());
    throw new UserExecException(message,e);
  }
}
