{
  JavaSemantics javaSemantics=createJavaSemantics();
  AndroidSemantics androidSemantics=createAndroidSemantics();
  NestedSetBuilder<Artifact> filesBuilder=NestedSetBuilder.stableOrder();
  ImmutableList<TransitiveInfoCollection> deps=ImmutableList.<TransitiveInfoCollection>copyOf(ruleContext.getPrerequisites("deps",Mode.TARGET));
  JavaCommon javaCommon=new JavaCommon(ruleContext,javaSemantics,deps,deps,deps);
  AndroidCommon androidCommon=new AndroidCommon(ruleContext,javaCommon,true,true);
  AndroidTools tools=AndroidTools.fromRuleContext(ruleContext);
  if (tools == null) {
    return null;
  }
  try {
    RuleConfiguredTargetBuilder builder=init(ruleContext,filesBuilder,getTransitiveResourceContainers(ruleContext,ImmutableList.of("resources","deps")),javaCommon,androidCommon,javaSemantics,androidSemantics,tools,ImmutableList.<String>of("deps"));
    if (builder == null) {
      return null;
    }
    return builder.build();
  }
 catch (  RuleConfigurationException e) {
    Preconditions.checkArgument(ruleContext.hasErrors(),"Exception caught but no errors reported:\n %s",Joiner.on("\n").join(e.getStackTrace()));
    return null;
  }
}
