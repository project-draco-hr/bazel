{
  DexArchiveProvider.Builder result=new DexArchiveProvider.Builder().addTransitiveProviders(ruleContext.getPrerequisites("deps",Mode.TARGET,DexArchiveProvider.class));
  for (  Artifact jar : common.getJarsProducedForRuntime()) {
    PathFragment jarPath=jar.getRootRelativePath();
    Artifact dexArchive=ruleContext.getDerivedArtifact(jarPath.replaceName(jarPath.getBaseName() + ".dex.zip"),jar.getRoot());
    DexArchiveAspect.createDexArchiveAction(ruleContext,jar,dexArchive,dexopts);
    result.addDexArchive(dexArchive,jar);
  }
  return result.build();
}
