{
  ConfigurationCollectionKey collectionKey=(ConfigurationCollectionKey)skyKey.argument();
  try {
    BuildConfigurationCollection result=getConfigurations(env,new SkyframePackageLoaderWithValueEnvironment(env,configurationPackages.get()),collectionKey.getBuildOptions(),collectionKey.getMultiCpu());
    if (env.valuesMissing()) {
      return null;
    }
    for (    BuildConfiguration config : result.getTargetConfigurations()) {
      config.declareSkyframeDependencies(env);
    }
    if (env.valuesMissing()) {
      return null;
    }
    return new ConfigurationCollectionValue(result,configurationPackages.get());
  }
 catch (  InvalidConfigurationException e) {
    throw new ConfigurationCollectionFunctionException(e);
  }
}
