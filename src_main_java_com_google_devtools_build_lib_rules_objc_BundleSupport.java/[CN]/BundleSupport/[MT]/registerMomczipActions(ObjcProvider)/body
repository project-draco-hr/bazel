{
  ObjcConfiguration objcConfiguration=ObjcRuleClasses.objcConfiguration(ruleContext);
  IntermediateArtifacts intermediateArtifacts=ObjcRuleClasses.intermediateArtifacts(ruleContext);
  Iterable<Xcdatamodel> xcdatamodels=Xcdatamodels.xcdatamodels(intermediateArtifacts,objcProvider.get(ObjcProvider.XCDATAMODEL));
  for (  Xcdatamodel datamodel : xcdatamodels) {
    Artifact outputZip=datamodel.getOutputZip();
    ruleContext.registerAction(ObjcActionsBuilder.spawnJavaOnDarwinActionBuilder(attributes.momczipDeployJar()).setMnemonic("MomCompile").addOutput(outputZip).addInputs(datamodel.getInputs()).setCommandLine(CustomCommandLine.builder().addPath(outputZip.getExecPath()).add(datamodel.archiveRootForMomczip()).add(IosSdkCommands.MOMC_PATH).add("-XD_MOMC_SDKROOT=" + IosSdkCommands.sdkDir(objcConfiguration)).add("-XD_MOMC_IOS_TARGET_VERSION=" + bundling.getMinimumOsVersion()).add("-MOMC_PLATFORMS").add(objcConfiguration.getBundlingPlatform().getLowerCaseNameInPlist()).add("-XD_MOMC_TARGET_VERSION=10.6").add(datamodel.getContainer().getSafePathString()).build()).build(ruleContext));
  }
}
