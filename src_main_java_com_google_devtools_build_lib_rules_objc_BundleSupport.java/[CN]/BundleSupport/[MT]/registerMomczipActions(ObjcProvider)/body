{
  AppleConfiguration appleConfiguration=ruleContext.getFragment(AppleConfiguration.class);
  IntermediateArtifacts intermediateArtifacts=ObjcRuleClasses.intermediateArtifacts(ruleContext);
  Iterable<Xcdatamodel> xcdatamodels=Xcdatamodels.xcdatamodels(intermediateArtifacts,objcProvider.get(ObjcProvider.XCDATAMODEL));
  for (  Xcdatamodel datamodel : xcdatamodels) {
    Artifact outputZip=datamodel.getOutputZip();
    ruleContext.registerAction(ObjcRuleClasses.spawnXcrunActionBuilder(ruleContext).setMnemonic("MomCompile").setExecutable(attributes.momcWrapper()).addOutput(outputZip).addInputs(datamodel.getInputs()).addInput(attributes.realpath()).addInput(CompilationSupport.xcrunwrapper(ruleContext).getExecutable()).setCommandLine(CustomCommandLine.builder().addPath(outputZip.getExecPath()).add(datamodel.archiveRootForMomczip()).add("-XD_MOMC_SDKROOT=" + AppleToolchain.sdkDir()).add("-XD_MOMC_IOS_TARGET_VERSION=" + bundling.getMinimumOsVersion()).add("-MOMC_PLATFORMS").add(appleConfiguration.getBundlingPlatform().getLowerCaseNameInPlist()).add("-XD_MOMC_TARGET_VERSION=10.6").add(datamodel.getContainer().getSafePathString()).build()).build(ruleContext));
  }
}
