{
  try {
    Map<PathFragment,Path> mounts=new HashMap<>();
    mountInputs(mounts,spawn,executionContext);
    Map<PathFragment,Path> unfinalized=new HashMap<>();
    mountRunfilesFromManifests(unfinalized,spawn);
    mountRunfilesFromSuppliers(unfinalized,spawn);
    mountFilesFromFilesetManifests(unfinalized,spawn,executionContext);
    mounts.putAll(finalizeLinks(unfinalized));
    return mounts;
  }
 catch (  IllegalArgumentException|IOException e) {
    throw new EnvironmentalExecException("Could not prepare mounts for sandbox execution",e);
  }
}
