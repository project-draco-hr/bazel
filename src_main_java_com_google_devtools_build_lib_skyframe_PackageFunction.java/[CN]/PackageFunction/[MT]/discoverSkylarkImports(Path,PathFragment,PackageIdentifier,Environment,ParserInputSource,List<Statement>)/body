{
  StoredEventHandler eventHandler=new StoredEventHandler();
  BuildFileAST buildFileAST=BuildFileAST.parseBuildFile(inputSource,preludeStatements,eventHandler,null,false);
  SkylarkImportResult importResult;
  boolean includeRepositoriesFetched;
  if (eventHandler.hasErrors()) {
    importResult=new SkylarkImportResult(ImmutableMap.<PathFragment,com.google.devtools.build.lib.syntax.Environment>of(),ImmutableList.<Label>of());
    includeRepositoriesFetched=true;
  }
 else {
    importResult=fetchImportsFromBuildFile(buildFilePath,buildFileFragment,packageId,buildFileAST,env);
    includeRepositoriesFetched=fetchIncludeRepositoryDeps(env,buildFileAST);
  }
  if (!includeRepositoriesFetched) {
    return null;
  }
  return importResult;
}
