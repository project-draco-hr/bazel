{
  scratch.file("foo/BUILD","cc_library(name = 'foo',","          srcs = ['foo.cc'],","          deps = ['//bar', '//boo'])");
  scratch.file("bar/BUILD","cc_library(name = 'bar',","           srcs = ['bar.cc',","                   'bargen.h',","                   'bargen2.h'],","           deps = ['//baz', '//boo'])","genrule(name = 'generated',","        srcs = ['gen.py'],","        cmd = 'gen.py',","        outs = ['bargen.h'])","genrule(name = 'generated2',","        srcs = ['gen.py'],","        cmd = 'gen.py',","        outs = ['bargen2.h'])");
  scratch.file("baz/BUILD","cc_library(name = 'baz',","           srcs = ['baz.cc',","                   'bazgen.h'])","genrule(name = 'generated',","        srcs = ['gen.py'],","        cmd = 'gen.py',","        outs = ['bazgen.h'])");
  scratch.file("boo/BUILD","cc_library(name = 'boo',","           srcs = ['boo.cc',","                   'boogen.h'])","genrule(name = 'boogen',","        srcs = ['gen.py'],","        cmd = 'gen.py',","        outs = ['boogen.h'])");
}
