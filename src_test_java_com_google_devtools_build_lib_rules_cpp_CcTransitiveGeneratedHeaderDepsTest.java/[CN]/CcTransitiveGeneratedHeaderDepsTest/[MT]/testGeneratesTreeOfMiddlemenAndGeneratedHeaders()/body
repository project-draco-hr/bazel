{
  ConfiguredTarget fooLib=setupWithOptions("--noextract_generated_inclusions");
  Set<Artifact> middlemen=fooLib.getProvider(CppCompilationContext.class).getCompilationPrerequisites();
  assertEquals(joinLines("middleman-0","  middleman-1","    bargen.h","    bargen2.h","    middleman-2","      bazgen.h","    middleman-3","      boogen.h","  middleman-3","    boogen.h",""),new MiddlemenRenderer(middlemen).toString());
}
