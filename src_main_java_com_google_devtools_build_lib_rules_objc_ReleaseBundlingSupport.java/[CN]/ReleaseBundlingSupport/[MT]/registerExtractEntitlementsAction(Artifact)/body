{
  String shellCommand="set -e && " + "PLIST=$(mktemp -t entitlements.plist) && trap \"rm ${PLIST}\" EXIT && " + extractPlistCommand(attributes.provisioningProfile()) + " > ${PLIST} && "+ "/usr/libexec/PlistBuddy -x -c 'Print Entitlements' ${PLIST} > "+ entitlements.getShellEscapedExecPathString();
  ruleContext.registerAction(ObjcRuleClasses.spawnBashOnDarwinActionBuilder(shellCommand).setMnemonic("ExtractIosEntitlements").setProgressMessage("Extracting entitlements: " + ruleContext.getLabel()).addInput(attributes.provisioningProfile()).addOutput(entitlements).build(ruleContext));
  return this;
}
