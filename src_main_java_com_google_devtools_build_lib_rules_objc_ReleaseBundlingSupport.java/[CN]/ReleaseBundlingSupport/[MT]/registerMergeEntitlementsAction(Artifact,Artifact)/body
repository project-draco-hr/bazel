{
  PlMergeControlBytes controlBytes=PlMergeControlBytes.fromPlists(NestedSetBuilder.create(Order.STABLE_ORDER,substitutedEntitlements,extraEntitlements),intermediateArtifacts.entitlements());
  Artifact plMergeControlArtifact=ObjcRuleClasses.artifactByAppendingToBaseName(ruleContext,".merge-entitlements-control");
  ruleContext.registerAction(new BinaryFileWriteAction(ruleContext.getActionOwner(),plMergeControlArtifact,controlBytes,false));
  ruleContext.registerAction(new SpawnAction.Builder().setMnemonic("MergeEntitlementsFiles").setExecutable(attributes.plmerge()).addArgument("--control").addInputArgument(plMergeControlArtifact).addInput(substitutedEntitlements).addInput(extraEntitlements).addOutput(intermediateArtifacts.entitlements()).build(ruleContext));
}
