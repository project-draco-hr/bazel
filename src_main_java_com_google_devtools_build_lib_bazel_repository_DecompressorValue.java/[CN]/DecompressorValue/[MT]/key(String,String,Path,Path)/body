{
  String baseName=archivePath.getBaseName();
  DecompressorDescriptor descriptor=new DecompressorDescriptor(targetKind,targetName,archivePath,repositoryPath);
  if (baseName.endsWith(".zip") || baseName.endsWith(".jar") || baseName.endsWith(".war")) {
    return new SkyKey(ZipFunction.NAME,descriptor);
  }
 else   if (baseName.endsWith(".tar.gz") || baseName.endsWith(".tgz")) {
    return new SkyKey(TarGzFunction.NAME,descriptor);
  }
 else {
    throw new IOException(String.format("Expected %s %s to create file with a .zip, .jar, .war, .tar.gz, or .tgz" + " suffix (got %s)",targetKind,targetName,archivePath));
  }
}
