{
  Preconditions.checkState(isReady(),"%s %s",this,value);
  Preconditions.checkState(this.version.atMost(version),"%s %s %s",this,version,value);
  if (isDirty() && buildingState.unchangedFromLastBuild(value)) {
    this.value=buildingState.getLastBuildValue();
  }
 else {
    this.version=version;
    this.value=value;
  }
  return setStateFinishedAndReturnReverseDeps();
}
