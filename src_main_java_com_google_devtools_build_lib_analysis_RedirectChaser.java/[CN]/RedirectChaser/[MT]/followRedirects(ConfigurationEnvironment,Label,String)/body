{
  Set<Label> visitedLabels=new HashSet<>();
  visitedLabels.add(label);
  try {
    while (true) {
      Target possibleRedirect=env.getTarget(label);
      if (possibleRedirect == null) {
        return null;
      }
      Label newLabel=getFilegroupRedirect(possibleRedirect);
      if (newLabel == null) {
        newLabel=getBindOrAliasRedirect(possibleRedirect);
      }
      if (newLabel == null) {
        return label;
      }
      newLabel=label.resolveRepositoryRelative(newLabel);
      label=newLabel;
      if (!visitedLabels.add(label)) {
        throw new InvalidConfigurationException("The " + name + " points to a filegroup which "+ "recursively includes itself. The label "+ label+ " is part of the loop");
      }
    }
  }
 catch (  NoSuchPackageException e) {
    env.getEventHandler().handle(Event.error(e.getMessage()));
    throw new InvalidConfigurationException(e.getMessage(),e);
  }
catch (  NoSuchTargetException e) {
    return label;
  }
}
