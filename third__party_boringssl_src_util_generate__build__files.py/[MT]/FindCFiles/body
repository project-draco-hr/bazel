def FindCFiles(directory, filter_func):
    'Recurses through directory and returns a list of paths to all the C source\n  files that pass filter_func.'
    cfiles = []
    for (path, dirnames, filenames) in os.walk(directory):
        for filename in filenames:
            if ((not filename.endswith('.c')) and (not filename.endswith('.cc'))):
                continue
            if (not filter_func(filename, False)):
                continue
            cfiles.append(os.path.join(path, filename))
        for (i, dirname) in enumerate(dirnames):
            if (not filter_func(dirname, True)):
                del dirnames[i]
    return cfiles
