{
  MountMap mounts=new MountMap();
  FileSystem fs=blazeDirs.getFileSystem();
  Map<PathFragment,Map<PathFragment,Artifact>> rootsAndMappings=spawn.getRunfilesSupplier().getMappings();
  for (  Entry<PathFragment,Map<PathFragment,Artifact>> rootAndMappings : rootsAndMappings.entrySet()) {
    Path root=fs.getRootDirectory().getRelative(rootAndMappings.getKey());
    for (    Entry<PathFragment,Artifact> mapping : rootAndMappings.getValue().entrySet()) {
      Artifact sourceArtifact=mapping.getValue();
      Path source=(sourceArtifact != null) ? sourceArtifact.getPath() : fs.getPath("/dev/null");
      Preconditions.checkArgument(!mapping.getKey().isAbsolute());
      Path target=root.getRelative(mapping.getKey());
      mounts.put(target,source);
    }
  }
  return mounts;
}
