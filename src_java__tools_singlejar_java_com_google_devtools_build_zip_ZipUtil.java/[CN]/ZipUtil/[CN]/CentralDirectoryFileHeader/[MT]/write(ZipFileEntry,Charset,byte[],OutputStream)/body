{
  if (buf == null || buf.length < FIXED_DATA_SIZE) {
    buf=new byte[FIXED_DATA_SIZE];
  }
  byte[] name=entry.getName().getBytes(charset);
  byte[] extra=entry.getExtra() != null ? entry.getExtra() : new byte[]{};
  byte[] comment=entry.getComment() != null ? entry.getComment().getBytes(charset) : new byte[]{};
  fillFixedSizeData(buf,entry,name.length,extra.length,comment.length);
  stream.write(buf,0,FIXED_DATA_SIZE);
  stream.write(name);
  stream.write(extra);
  stream.write(comment);
  return FIXED_DATA_SIZE + name.length + extra.length+ comment.length;
}
