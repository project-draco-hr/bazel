{
  Build.Package packagePb=Build.Package.parseDelimitedFrom(in);
  Package.Builder builder;
  try {
    builder=new Package.Builder(new PackageIdentifier(packagePb.getRepository(),new PathFragment(packagePb.getName())),null);
  }
 catch (  TargetParsingException e) {
    throw new PackageDeserializationException(e);
  }
  StoredEventHandler eventHandler=new StoredEventHandler();
  deserializeInternal(packagePb,eventHandler,builder,in);
  builder.addEvents(eventHandler.getEvents());
  return builder.build();
}
