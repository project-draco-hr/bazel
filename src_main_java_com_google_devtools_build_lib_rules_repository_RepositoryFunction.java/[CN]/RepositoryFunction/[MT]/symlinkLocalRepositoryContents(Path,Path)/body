{
  try {
    FileSystemUtils.createDirectoryAndParents(repositoryDirectory);
    FileSystem fs=repositoryDirectory.getFileSystem();
    if (repositoryDirectory.getFileSystem().supportsSymbolicLinksNatively()) {
      for (      Path target : targetDirectory.getDirectoryEntries()) {
        Path symlinkPath=repositoryDirectory.getRelative(target.getBaseName());
        createSymbolicLink(symlinkPath,target);
      }
    }
 else {
      FileSystemUtils.copyTreesBelow(targetDirectory,repositoryDirectory);
    }
  }
 catch (  IOException e) {
    throw new RepositoryFunctionException(e,Transience.TRANSIENT);
  }
  return true;
}
