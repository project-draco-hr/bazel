{
  if (action.inputsKnown()) {
    return new AllInputs(action.getInputs());
  }
  Preconditions.checkState(action.discoversInputs(),action);
  PackageRootResolverWithEnvironment resolver=new PackageRootResolverWithEnvironment(env);
  Iterable<Artifact> actionCacheInputs=skyframeActionExecutor.getActionCachedInputs(action,resolver);
  if (actionCacheInputs == null) {
    Preconditions.checkState(env.valuesMissing(),action);
    return null;
  }
  return new AllInputs(action.getInputs(),actionCacheInputs,resolver.keysRequested);
}
