{
  AndroidIdeInfoProvider.Builder ideInfoProviderBuilder=new AndroidIdeInfoProvider.Builder().setJavaPackage(getJavaPackage(ruleContext)).setIdlClassJar(idlHelper.getIdlClassJar()).setIdlSourceJar(idlHelper.getIdlSourceJar()).addIdlParcelables(idlHelper.getIdlParcelables()).addIdlSrcs(idlHelper.getIdlSources()).addIdlGeneratedJavaFiles(idlHelper.getIdlGeneratedJavaSources()).addAllApksUnderTest(apksUnderTest);
  if (zipAlignedApk != null) {
    ideInfoProviderBuilder.setApk(zipAlignedApk);
  }
  if (LocalResourceContainer.definesAndroidResources(ruleContext.attributes())) {
    ideInfoProviderBuilder.setDefinesAndroidResources(true).addResourceSources(resourceApk.getPrimaryResource().getArtifacts(ResourceType.RESOURCES)).addAssetSources(resourceApk.getPrimaryResource().getArtifacts(ResourceType.ASSETS),getAssetDir(ruleContext)).setGeneratedManifest(resourceApk.getPrimaryResource().getManifest()).setManifest(ruleContext.getPrerequisiteArtifact("manifest",Mode.TARGET));
  }
 else {
    semantics.addNonLocalResources(ruleContext,resourceApk,ideInfoProviderBuilder);
  }
  return ideInfoProviderBuilder.build();
}
