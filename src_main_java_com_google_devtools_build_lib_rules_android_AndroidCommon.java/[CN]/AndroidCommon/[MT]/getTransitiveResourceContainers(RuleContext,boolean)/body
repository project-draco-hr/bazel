{
  NestedSetBuilder<ResourceContainer> resourcesBuilder=NestedSetBuilder.naiveLinkOrder();
  List<String> attributes=new ArrayList<>();
  attributes.add("resources");
  if (withDeps) {
    attributes.add("deps");
  }
  for (  String attribute : attributes) {
    if (!ruleContext.attributes().has(attribute,BuildType.LABEL) && !ruleContext.attributes().has(attribute,BuildType.LABEL_LIST)) {
      continue;
    }
    for (    AndroidResourcesProvider resources : ruleContext.getPrerequisites(attribute,Mode.TARGET,AndroidResourcesProvider.class)) {
      resourcesBuilder.addTransitive(resources.getTransitiveAndroidResources());
    }
  }
  return resourcesBuilder.build();
}
