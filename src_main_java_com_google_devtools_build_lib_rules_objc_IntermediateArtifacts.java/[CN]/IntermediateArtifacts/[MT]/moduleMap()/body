{
  if (!buildConfiguration.getFragment(ObjcConfiguration.class).moduleMapsEnabled()) {
    throw new IllegalStateException();
  }
  String moduleName=ruleContext.getLabel().toString().replace("//","").replace("/","_").replace(":","_");
  return new CppModuleMap(appendExtensionInGenfiles(".modulemaps/module.modulemap"),moduleName);
}
