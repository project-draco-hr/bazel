{
  reporter.removeHandler(failFastHandler);
  scratch.file("a/BUILD","genrule(name = 'conflict1', cmd = '', srcs = [], outs = ['conflict'])","genrule(name = 'conflict2', cmd = '', srcs = [], outs = ['conflict'])");
  String labelName="//a:conflict1";
  NoSuchTargetException exn=(NoSuchTargetException)getErrorFromTargetValue(labelName);
  assertThat(exn.getMessage()).contains("Target '//a:conflict1' contains an error and its package is in error");
  assertEquals(labelName,exn.getLabel().toString());
  assertTrue(exn.hasTarget());
}
