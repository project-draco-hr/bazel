{
  Path myPkgPath=scratch.resolve("/foo/workspace/mypkg/BUILD");
  Package.Builder pkgBuilder=new Package.Builder(PackageIdentifier.createInMainRepo("mypkg"),"TESTING").setFilename(myPkgPath).setMakeEnv(new MakeEnvironment.Builder());
  Map<String,Object> attributeValues=new HashMap<>();
  attributeValues.put("name","foo");
  attributeValues.put("actual","//bar:baz");
  try {
    RuleFactory.createAndAddRule(pkgBuilder,provider.getRuleClassMap().get("bind"),new BuildLangTypedAttributeValuesMap(attributeValues),new Reporter(),null,LOCATION_42,null);
    fail();
  }
 catch (  RuleFactory.InvalidRuleException e) {
    assertThat(e.getMessage()).contains("must be in the WORKSPACE file");
  }
}
