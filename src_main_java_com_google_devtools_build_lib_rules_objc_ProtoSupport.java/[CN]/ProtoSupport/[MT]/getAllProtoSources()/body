{
  NestedSetBuilder<Artifact> protos=NestedSetBuilder.stableOrder();
  if (experimentalAutoUnion() && targetType == TargetType.LINKING_TARGET) {
    Iterable<ObjcProtoProvider> objcProtoProviders=ruleContext.getPrerequisites("deps",Mode.TARGET,ObjcProtoProvider.class);
    for (    ObjcProtoProvider objcProtoProvider : objcProtoProviders) {
      protos.addTransitive(objcProtoProvider.getProtoSources());
    }
  }
  protos.addTransitive(attributes.getProtoFiles());
  return protos.build();
}
