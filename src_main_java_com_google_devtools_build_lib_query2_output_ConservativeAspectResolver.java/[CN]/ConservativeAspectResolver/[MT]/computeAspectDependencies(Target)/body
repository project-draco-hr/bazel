{
  if (!(target instanceof Rule)) {
    return ImmutableMultimap.of();
  }
  Multimap<Attribute,Label> result=LinkedHashMultimap.create();
  for (  Attribute attribute : ((Rule)target).getAttributes()) {
    for (    AspectClass aspectFactory : attribute.getAspects()) {
      AspectDefinition.addAllAttributesOfAspect((Rule)target,result,aspectFactory.getDefinition(),Rule.ALL_DEPS);
    }
  }
  return ImmutableMultimap.copyOf(result);
}
