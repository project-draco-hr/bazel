{
  if (!(target instanceof Rule)) {
    return ImmutableMultimap.of();
  }
  Rule rule=(Rule)target;
  Multimap<Attribute,Label> result=LinkedHashMultimap.create();
  for (  Attribute attribute : rule.getAttributes()) {
    for (    AspectWithParameters aspectWithParameters : attribute.getAspectsWithParameters(rule)) {
      AspectDefinition.addAllAttributesOfAspect(rule,result,aspectWithParameters.getDefinition(),Rule.ALL_DEPS);
    }
  }
  return ImmutableMultimap.copyOf(result);
}
