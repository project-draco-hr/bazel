{
  Artifact outputArchive=ruleContext.getImplicitOutputArtifact(CompilationSupport.FULLY_LINKED_LIB);
  ImmutableList<Artifact> ccLibraries=ccLibraries(objcProvider);
  ruleContext.registerAction(ObjcRuleClasses.spawnAppleEnvActionBuilder(ruleContext,appleConfiguration.getIosCpuPlatform()).setMnemonic("ObjcLink").setExecutable(xcrunwrapper(ruleContext)).setCommandLine(new CustomCommandLine.Builder().add(LIBTOOL).add("-static").add("-arch_only").add(appleConfiguration.getIosCpu()).add("-syslibroot").add(AppleToolchain.sdkDir()).add("-o").add(outputArchive.getExecPathString()).addExecPaths(objcProvider.get(LIBRARY)).addExecPaths(objcProvider.get(IMPORTED_LIBRARY)).addExecPaths(ccLibraries).build()).addInputs(ccLibraries).addTransitiveInputs(objcProvider.get(LIBRARY)).addTransitiveInputs(objcProvider.get(IMPORTED_LIBRARY)).addOutput(outputArchive).build(ruleContext));
  return this;
}
