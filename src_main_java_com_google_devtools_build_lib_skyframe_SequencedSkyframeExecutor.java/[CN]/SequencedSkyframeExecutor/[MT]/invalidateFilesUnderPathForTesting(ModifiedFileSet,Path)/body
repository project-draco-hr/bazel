{
  if (lastAnalysisDiscarded) {
    dropConfiguredTargetsNow();
    lastAnalysisDiscarded=false;
  }
  Iterable<SkyKey> keys;
  if (modifiedFileSet.treatEverythingAsModified()) {
    Differencer.Diff diff=new FilesystemValueChecker(memoizingEvaluator,tsgm,null).getDirtyKeys(new BasicFilesystemDirtinessChecker());
    keys=diff.changedKeysWithoutNewValues();
    recordingDiffer.inject(diff.changedKeysWithNewValues());
  }
 else {
    keys=getSkyKeysPotentiallyAffected(modifiedFileSet.modifiedSourceFiles(),pathEntry);
  }
  syscalls.set(new PerBuildSyscallCache());
  recordingDiffer.invalidate(keys);
  invalidateTransientErrors();
}
