{
  if (isInternal(rootedPath,pkgLocator.get())) {
    return;
  }
  externalFileSeen=true;
  if (externalFileAction == ExternalFileAction.DEPEND_ON_EXTERNAL_PKG) {
    PackageValue pkgValue=(PackageValue)env.getValue(PackageValue.key(PackageIdentifier.createInDefaultRepo(PackageIdentifier.EXTERNAL_PREFIX)));
    if (pkgValue == null) {
      return;
    }
    Preconditions.checkState(!pkgValue.getPackage().containsErrors());
  }
 else {
    throw new FileOutsidePackageRootsException(rootedPath);
  }
}
