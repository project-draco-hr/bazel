{
  if (env == null) {
    return args;
  }
  boolean hasName=args.containsKey("generator_name");
  boolean hasFunc=args.containsKey("generator_function");
  if (hasName || hasFunc) {
    return args;
  }
  Pair<BaseFunction,Location> topCall=env.getTopCall();
  if (topCall == null || !(topCall.first instanceof UserDefinedFunction)) {
    return args;
  }
  ImmutableMap.Builder<String,Object> builder=ImmutableMap.builder();
  builder.putAll(args);
  builder.put("generator_name",args.get("name"));
  builder.put("generator_function",topCall.first.getName());
  builder.put("generator_location",topCall.second.toString());
  try {
    return builder.build();
  }
 catch (  IllegalArgumentException ex) {
    return args;
  }
}
