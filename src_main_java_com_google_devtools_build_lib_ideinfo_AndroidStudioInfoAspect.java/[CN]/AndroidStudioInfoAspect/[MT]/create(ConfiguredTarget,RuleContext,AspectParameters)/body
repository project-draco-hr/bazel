{
  Aspect.Builder builder=new Builder(NAME);
  AndroidStudioInfoFilesProvider.Builder providerBuilder=new AndroidStudioInfoFilesProvider.Builder();
  RuleIdeInfo.Kind ruleKind=getRuleKind(ruleContext.getRule(),base);
  NestedSet<Label> directDependencies=processDependencies(base,ruleContext,providerBuilder,ruleKind);
  AndroidStudioInfoFilesProvider provider;
  if (ruleKind != RuleIdeInfo.Kind.UNRECOGNIZED) {
    provider=createIdeBuildArtifact(base,ruleContext,ruleKind,directDependencies,providerBuilder);
  }
 else {
    provider=providerBuilder.build();
  }
  NestedSet<Artifact> ideInfoFiles=provider.getIdeBuildFiles();
  builder.addOutputGroup(IDE_BUILD,ideInfoFiles).addProvider(AndroidStudioInfoFilesProvider.class,provider);
  return builder.build();
}
