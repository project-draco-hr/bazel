{
  OptionsParser optionsParser=OptionsParser.newOptionsParser(ImmutableList.<Class<? extends OptionsBase>>copyOf(ruleClassProvider.getOptionFragments()));
  InvocationPolicyEnforcer optionsPolicyEnforcer=new InvocationPolicyEnforcer(TestConstants.TEST_INVOCATION_POLICY);
  try {
    optionsPolicyEnforcer.enforce(optionsParser);
  }
 catch (  OptionsParsingException e) {
    throw new IllegalStateException(e);
  }
  return optionsParser;
}
