{
  Package.Builder builder=Package.newExternalPackageBuilder(workspacePath,ruleClassProvider.getRunfilesPrefix());
  try (Mutability mutability=Mutability.create("External Package %s",workspacePath)){
    new WorkspaceFactory(builder,ruleClassProvider,environmentExtensions,mutability).parse(ParserInputSource.create(workspacePath));
  }
 catch (  IOException|InterruptedException e) {
    handler.handle(Event.error(Location.fromFile(workspacePath),e.getMessage()));
  }
  return builder.build();
}
