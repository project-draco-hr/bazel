{
  byte[] multiplexed=lines("@1@","out","@2@","err","@3@","ctl","");
  StreamDemultiplexer demux=new StreamDemultiplexer((byte)'1',out,err,ctl);
  try {
    demux.write(multiplexed);
    demux.flush();
  }
  finally {
    demux.close();
  }
  assertEquals("out",toAnsi(out));
  assertEquals("err",toAnsi(err));
  assertEquals("ctl",toAnsi(ctl));
}
