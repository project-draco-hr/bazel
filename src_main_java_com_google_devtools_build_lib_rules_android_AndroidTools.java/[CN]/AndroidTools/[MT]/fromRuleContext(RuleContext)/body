{
  TransitiveInfoCollection androidSdkDep=ruleContext.getPrerequisite(":android_sdk",Mode.TARGET);
  AndroidSdkProvider androidSdk=androidSdkDep == null ? null : androidSdkDep.getProvider(AndroidSdkProvider.class);
  if (androidSdk == null && !Constants.ANDROID_ALLOW_SDK_FILEGROUP) {
    ruleContext.ruleError("No Android SDK found. Use the --android_sdk command line option to specify one.");
    return null;
  }
  return new AndroidTools(ruleContext,androidSdk,getOptionalArtifact(ruleContext,"$android_dx_jar"),getOptionalArtifact(ruleContext,"$android_jar",Mode.TARGET),getOptionalArtifact(ruleContext,"$shrinked_android"),getOptionalArtifact(ruleContext,"$android_annotations_jar"),getOptionalArtifact(ruleContext,"$multidex_keep_classes"),getOptionalArtifact(ruleContext,"$android_apkbuilder_tool"),getOptionalArtifact(ruleContext,"$android_aidl_tool"),getOptionalArtifact(ruleContext,"$android_aidl_framework"),getOptionalToolFromArtifact(ruleContext,"$android_aapt"),getOptionalToolFromArtifact(ruleContext,"$adb"),getOptionalTool(ruleContext,"$android_tool_runner"),getOptionalTool(ruleContext,"$android_aapt_java_generator"),getOptionalTool(ruleContext,"$android_aapt_apk_generator"),getOptionalTool(ruleContext,":android_resources_processor"),getOptionalTool(ruleContext,":android_aar_generator"),getOptionalTool(ruleContext,"$zipalign_tool"),getOptionalTool(ruleContext,":proguard"));
}
