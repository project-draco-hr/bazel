{
  InstrumentedFilesProvider instrumentedFilesProvider=InstrumentedFilesCollector.collect(ruleContext,semantics.getCoverageInstrumentationSpec(),JAVA_METADATA_COLLECTOR,filesToBuild,!TargetUtils.isTestRule(ruleContext.getTarget()));
  builder.add(InstrumentedFilesProvider.class,instrumentedFilesProvider).add(JavaExportsProvider.class,new JavaExportsProvider(collectTransitiveExports())).addOutputGroup(OutputGroupProvider.FILES_TO_COMPILE,getFilesToCompile(classJar));
}
