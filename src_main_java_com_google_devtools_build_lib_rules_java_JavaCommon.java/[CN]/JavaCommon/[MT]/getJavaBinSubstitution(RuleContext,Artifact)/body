{
  Preconditions.checkState(ruleContext.getConfiguration().hasFragment(Jvm.class));
  PathFragment javaExecutable;
  if (launcher != null) {
    javaExecutable=launcher.getRootRelativePath();
  }
 else {
    javaExecutable=ruleContext.getFragment(Jvm.class).getRunfilesJavaExecutable();
  }
  String pathPrefix=javaExecutable.isAbsolute() ? "" : "${JAVA_RUNFILES}/" + ruleContext.getRule().getWorkspaceName() + "/";
  return "JAVABIN=${JAVABIN:-" + pathPrefix + javaExecutable.getPathString()+ "}";
}
