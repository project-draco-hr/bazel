{
  tester.addFile("base/BUILD","cc_library(name = 'hello', srcs = ['hello.cc', '//bad:bad.cc'])");
  tester.useLoadingOptions("--compile_one_dependency");
  if (runsLoadingPhase()) {
    try {
      tester.load("base/hello.cc");
      fail();
    }
 catch (    TargetParsingException expected) {
      tester.assertContainsError("no such package 'bad'");
    }
  }
 else {
    LoadingResult loadingResult=tester.loadKeepGoing("base/hello.cc");
    assertThat(loadingResult.hasTargetPatternError()).isTrue();
  }
}
