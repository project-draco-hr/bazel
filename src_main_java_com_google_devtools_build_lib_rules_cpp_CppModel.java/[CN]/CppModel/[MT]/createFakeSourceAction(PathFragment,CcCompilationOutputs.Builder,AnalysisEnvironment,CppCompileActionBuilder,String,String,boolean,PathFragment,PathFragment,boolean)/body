{
  if (usePic) {
    outputExtension=".pic" + outputExtension;
    dependencyFileExtension=".pic" + dependencyFileExtension;
  }
  Artifact outputFile=ruleContext.getRelatedArtifact(outputName,outputExtension);
  PathFragment tempOutputName=FileSystemUtils.replaceExtension(outputFile.getExecPath(),".temp" + outputExtension,outputExtension);
  builder.setPicMode(usePic).setOutputFile(outputFile).setDotdFile(outputName,dependencyFileExtension).setTempOutputFile(tempOutputName);
  setupBuildVariables(builder,getGeneratePicActions(),ccRelativeName,execPath,null);
  semantics.finalizeCompileActionBuilder(ruleContext,builder);
  CppCompileAction action=builder.build();
  env.registerAction(action);
  if (addObject) {
    if (usePic) {
      result.addPicObjectFile(action.getOutputFile());
    }
 else {
      result.addObjectFile(action.getOutputFile());
    }
  }
}
