{
  if (configuration.isCodeCoverageEnabled()) {
    final RegexFilter filter=configuration.getInstrumentationFilter();
    if (filter.isIncluded(ruleContext.getLabel().toString())) {
      return true;
    }
    if (ruleContext.getRule().isAttrDefined("deps",Type.LABEL_LIST)) {
      for (      TransitiveInfoCollection dep : ruleContext.getPrerequisites("deps",Mode.TARGET)) {
        if (dep.getProvider(CppCompilationContext.class) != null && filter.isIncluded(dep.getLabel().toString())) {
          return true;
        }
      }
    }
  }
  return false;
}
