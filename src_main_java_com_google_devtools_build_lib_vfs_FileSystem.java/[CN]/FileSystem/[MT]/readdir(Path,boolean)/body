{
  Collection<Path> children=getDirectoryEntries(path);
  List<Dirent> dirents=Lists.newArrayListWithCapacity(children.size());
  for (  Path child : children) {
    FileStatus stat=statNullable(child,followSymlinks);
    Dirent.Type type;
    if (stat == null) {
      type=Type.UNKNOWN;
    }
 else     if (stat.isFile()) {
      type=Type.FILE;
    }
 else     if (stat.isDirectory()) {
      type=Type.DIRECTORY;
    }
 else     if (stat.isSymbolicLink()) {
      type=Type.SYMLINK;
    }
 else {
      type=Type.UNKNOWN;
    }
    dirents.add(new Dirent(child.getBaseName(),type));
  }
  return dirents;
}
