{
  scratch.file("nobuild/BUILD","cc_library(name= 'lib')");
  useConfiguration("--experimental_action_listener=//nobuild:bar");
  reporter.removeHandler(failFastHandler);
  String begin=String.format("Failed to load required %s target: '%s'","action_listener","//nobuild:bar");
  try {
    update(defaultFlags().with(Flag.KEEP_GOING),"//nobuild:lib");
    fail();
  }
 catch (  InvalidConfigurationException e) {
    assertThat(e.getMessage()).startsWith(begin);
  }
catch (  LoadingFailedException e) {
    assertThat(e.getMessage()).startsWith(begin);
  }
  assertContainsEventWithFrequency("no such target '//nobuild:bar': target 'bar' not declared in package 'nobuild'",1);
}
